<!DOCTYPE html>
<html lang="zh-cmn-Hans">
  <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
  <meta http-equiv=â€Cache-Controlâ€ content="no-transform" />
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  
  <title>Caddy å¿«é€Ÿå®è·µ | voya</title>
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.icon">
  



<link rel="stylesheet" href="/./vendor.bb7611.css"><link rel="stylesheet" href="/./app.590fd5.css">


</head>
  <body>
    <header class="main-header">
  <div class="container">
    <a href="/"" class="logo">
      <img src="http://oe54phg1r.bkt.clouddn.com/blog/2017-07-26-075816.jpg" alt="voya" class="logo-img">
    </a>
    <span class="nav-separator"></span>
    <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="æœç´¢æ–‡ç« "><input type="hidden" name="sitesearch" value="http://www.voyax.me"></form>
    <a href="javascript:void(0);" class="nav-icon">
      <i class="fas fa-bars"></i>
    </a>
    <nav class="main-nav">
      <ul class="nav-list">
        
          <li class="nav-link ">
            <a href="../../index.html">é¦–é¡µ</a>
          </li>
        
          <li class="nav-link ">
            <a href="../../archives/">å½’æ¡£</a>
          </li>
        
          <li class="nav-link ">
            <a href="../../categories">åˆ†ç±»</a>
          </li>
        
          <li class="nav-link ">
            <a href="../../about">å…³äº</a>
          </li>
        
      </ul>
    </nav>
  </div>
</header>
    <div class="page--article">
  
    <div class="toc-container">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#æœ¬åœ°åªç”¨-Caddy"><span class="toc-number">1.</span> <span class="toc-text">æœ¬åœ°åªç”¨ Caddy</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å®‰è£…"><span class="toc-number">2.</span> <span class="toc-text">å®‰è£…</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#caddy-æœåŠ¡å™¨é…ç½®"><span class="toc-number">3.</span> <span class="toc-text">caddy æœåŠ¡å™¨é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Caddyfile-æ–‡ä»¶"><span class="toc-number">3.1.</span> <span class="toc-text">Caddyfile  æ–‡ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#æ–‡ä»¶æ ¼å¼"><span class="toc-number">3.1.1.</span> <span class="toc-text">æ–‡ä»¶æ ¼å¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#å¤šç«™ç‚¹é…ç½®"><span class="toc-number">3.1.2.</span> <span class="toc-text">å¤šç«™ç‚¹é…ç½®</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Mac-ç¯å¢ƒé…ç½®"><span class="toc-number">4.</span> <span class="toc-text">Mac ç¯å¢ƒé…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#å¼€æœºå¯åŠ¨"><span class="toc-number">4.1.</span> <span class="toc-text">å¼€æœºå¯åŠ¨</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åŸºæœ¬é…ç½®"><span class="toc-number">4.2.</span> <span class="toc-text">åŸºæœ¬é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#è‡ªå®šä¹‰é…ç½®æ–‡ä»¶"><span class="toc-number">4.2.1.</span> <span class="toc-text">è‡ªå®šä¹‰é…ç½®æ–‡ä»¶</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å¯åŠ¨ã€åœæ­¢ã€é‡å¯æœåŠ¡"><span class="toc-number">5.</span> <span class="toc-text">å¯åŠ¨ã€åœæ­¢ã€é‡å¯æœåŠ¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸Šçº¿é¡¹ç›®è¿˜è¯·æ¢å›-nginx"><span class="toc-number">6.</span> <span class="toc-text">ä¸Šçº¿é¡¹ç›®è¿˜è¯·æ¢å› nginx</span></a></li></ol>
      <div class="toc-tip">Table of Contents â–¼</div>
    </div>
  


  <div class="container">
    <article>
      <h1>Caddy å¿«é€Ÿå®è·µ</h1>
      <p><img src="http://oe54phg1r.bkt.clouddn.com/blog/2017-09-20-082101.jpg" alt=""></p>
<p>Caddy æ˜¯ä¸€ä¸ªå¯ä»¥<strong>çœŸçš„</strong>éå¸¸æ–¹ä¾¿å®‰è£…ã€é…ç½®ä»¥åŠè¿è¡Œçš„ web æœåŠ¡å™¨ï¼Œç›¸æ¯” Nginx æˆ–è€… Apacheï¼ŒCaddy æ›´é€‚åˆæˆ‘ä»¬å¿«é€Ÿæ­å»º web æœåŠ¡å™¨ï¼Œå¯é€‚åˆç»å¤§å¤§æ•°é¡¹ç›®éœ€æ±‚ã€‚</p>
<a id="more"></a>
<h2 id="æœ¬åœ°åªç”¨-Caddy"><a href="#æœ¬åœ°åªç”¨-Caddy" class="headerlink" title="æœ¬åœ°åªç”¨ Caddy"></a>æœ¬åœ°åªç”¨ Caddy</h2><p>ä½œä¸ºå¼€å‘äººå‘˜ï¼Œæˆ‘æ›´å…³å¿ƒå¼€å‘æ•ˆç‡ï¼ŒæœåŠ¡å™¨ç­‰ç¯å¢ƒçš„éƒ¨ç½²ç¡®å®ä¸æ˜¯æ“…é•¿çš„ï¼Œç»å¸¸é…ç½®ä¸€ä¸ª <code>Nginx</code> å³ä½¿ç…§ç€æ•™ç¨‹æ“ä½œè¿˜æ˜¯ä¼šå‡ºç°å„ç§è«åå…¶å¦™çš„é—®é¢˜ï¼Œæˆ–è€…ä¸€æ®µæ—¶é—´åï¼Œå‘ç° <code>Nginx</code>  ç«Ÿç„¶èµ·ä¸èµ·æ¥ï¼Œç½‘ä¸Šè¿˜æ˜¯å„ç§ä¸é è°±çš„ â€œè§£å†³æ–¹æ¡ˆâ€â€¦â€¦</p>
<p>ç›¸å¯¹äº <code>Nginx</code> å’Œ <code>Apache</code>ï¼ŒCaddy ç®€å•å¾ˆå¤šï¼Œè€Œä¸”æ²¡æœ‰ä»»ä½•å¤–éƒ¨ä¾èµ–ï¼Œä¸€ä¸ªé…ç½®æ–‡ä»¶æå®šã€‚è¿™æ˜¯åœ¨å¼€å‘ä¸­æœ€ä¸ºå…³æ³¨çš„ç‚¹ï¼š</p>
<ul>
<li>ç®€å•ï¼Œæ— éœ€èŠ±å¤šä½™ç»å†</li>
<li>æ— ä¾èµ–</li>
<li>åå‘ä»£ç†</li>
<li>æ”¯æŒè™šæ‹Ÿä¸»æœº</li>
<li>ä½¿ç”¨ <code>HTTP/2</code></li>
<li>è‡ªåŠ¨ç”Ÿæˆå’Œæ›´æ–° <code>ssl</code> è¯ä¹¦ </li>
<li>æ”¯æŒå„å¹³å°ï¼Œå®‰è£…ç®€å•</li>
</ul>
<p>å…·ä½“è¿˜æœ‰å“ªäº›ç‰¹æ€§ç§»æ­¥å®˜ç½‘æ–‡æ¡£ï¼ŒGaddy è¿˜æ”¯æŒæ’ä»¶æ‰©å±•ï¼Œgithub ä¸Šä¹Ÿå¾ˆæ´»è·ƒï¼Œå‰æ™¯çœ‹å¥½ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨ğŸ˜‰</p>
<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><pre><code class="bash"># mac
brew install caddy
</code></pre>
<p>å¯ä»¥ç›´æ¥ä»å®˜ç½‘ä¸‹è½½å®‰è£…ï¼Œä¸‹è½½çš„æ–‡ä»¶ä¸­è¿˜æœ‰ä¸€ä¸ª <code>init</code> æ–‡ä»¶å¤¹ï¼Œé‡Œè¾¹æœ‰åŸºæœ¬çš„é…ç½® demo</p>
<p>ç°åœ¨åœ¨ä»»æ„ä¸€ä¸ªç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª <code>index.html</code> æ–‡ä»¶ï¼Œè¿è¡Œ <code>caddy</code>ï¼š</p>
<pre><code class="bash">mkdir temp
touch index.html
vim index.html
</code></pre>
<p><img src="http://oe54phg1r.bkt.clouddn.com/2017-09-20-15058977676119.jpg" alt=""></p>
<p>ä¿å­˜ï¼Œç„¶åè¿è¡Œ <code>caddy</code>ï¼š</p>
<pre><code class="bash">caddy
</code></pre>
<p>è®¿é—® <a href="localhost:2015" target="_blank" rel="noopener">localhost:2015</a> ä½ å¯ä»¥çœ‹åˆ°æœåŠ¡å™¨å·²ç»æ­£å¸¸å¯åŠ¨äº†</p>
<p><img src="http://oe54phg1r.bkt.clouddn.com/2017-09-20-15058979215933.jpg" alt=""></p>
<h2 id="caddy-æœåŠ¡å™¨é…ç½®"><a href="#caddy-æœåŠ¡å™¨é…ç½®" class="headerlink" title="caddy æœåŠ¡å™¨é…ç½®"></a>caddy æœåŠ¡å™¨é…ç½®</h2><p><code>caddy</code> å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œ<strong>ä¼ å‚</strong>ä¹Ÿå¯é€šè¿‡ Caddyfile è¿›è¡Œé…ç½®ï¼Œæ¯”å¦‚æˆ‘ä»¬æŒ‡å®šåŸŸåå’Œç«¯å£ï¼š</p>
<pre><code class="bash">caddy -host localhost:8000
</code></pre>
<p>é€šè¿‡ Caddyfile é…ç½®ï¼š</p>
<pre><code class="bash">touch Caddyfile
vim Caddyfile
</code></pre>
<p>Caddyfile æ–‡ä»¶å†…å®¹ï¼š</p>
<pre><code>localhost:8000
</code></pre><h3 id="Caddyfile-æ–‡ä»¶"><a href="#Caddyfile-æ–‡ä»¶" class="headerlink" title="Caddyfile  æ–‡ä»¶"></a>Caddyfile  æ–‡ä»¶</h3><p>caddy é»˜è®¤å°†å½“å‰ç›®å½•ä¸‹çš„ Caddyfile ä½œä¸ºé…ç½®æ–‡ä»¶ï¼Œé€šè¿‡ <code>-conf</code> æŒ‡å®šé…ç½®æ–‡ä»¶è·¯å¾„ï¼š</p>
<pre><code class="bash">caddy -conf ../path/to/Caddyfile
</code></pre>
<h4 id="æ–‡ä»¶æ ¼å¼"><a href="#æ–‡ä»¶æ ¼å¼" class="headerlink" title="æ–‡ä»¶æ ¼å¼"></a>æ–‡ä»¶æ ¼å¼</h4><p>Caddyfile æ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œç”± <strong>åœ°å€</strong> å’Œ<strong>æŒ‡ä»¤</strong> ç»„æˆï¼Œçœ‹ä¸ªå¤æ‚ç‚¹çš„ä¾‹å­ï¼š</p>
<pre><code>localhost
gzip
tls self_signed # è‡ªç­¾å‘è¯ä¹¦
proxy /api 127.0.0.1:7005 # åå‘ä»£ç†
log /var/log/caddy/access.log
header /api {
    Access-Control-Allow-Origin  *
    Access-Control-Allow-Methods &quot;GET, POST, OPTIONS&quot;
    -Server
}
</code></pre><p>ç¬¬ä¸€è¡Œæ˜¯åœ°å€ï¼Œä¹‹åå°±æ˜¯æŒ‡ä»¤äº†ï¼Œå¦‚æœä¸€æ¡æŒ‡ä»¤æœ‰å¤šä¸ªå‚æ•°éœ€è¦æ¢è¡Œï¼Œç”¨ <code>{}</code> æ‹¬èµ·æ¥å°±å¥½ï¼Œå®Œæ•´æŒ‡ä»¤åŠè§£é‡Šè¯·æŸ¥çœ‹ <a href="https://caddyserver.com/docs" target="_blank" rel="noopener">æ–‡æ¡£</a></p>
<h4 id="å¤šç«™ç‚¹é…ç½®"><a href="#å¤šç«™ç‚¹é…ç½®" class="headerlink" title="å¤šç«™ç‚¹é…ç½®"></a>å¤šç«™ç‚¹é…ç½®</h4><p>å¦‚æœéœ€è¦åœ¨ä¸€ä¸ª caddy æœåŠ¡ä¸­å¯åŠ¨å¤šä¸ªç«™ç‚¹ï¼Œéœ€è¦åœ¨åŸŸååè¾¹åŠ ä¸Š <code>{}</code>ï¼Œå°†æŒ‡ä»¤å†™åˆ° <code>{}</code> ä¸­ï¼š</p>
<pre><code>mysite.com {
    root /www/mysite.com
}

sub.mysite.com {
    root /www/sub.mysite.com
    gzip
    log ../access.log
}
</code></pre><p>å¦‚æœè¿™ä¸¤ä¸ªç«™ç‚¹æœ‰é€šç”¨çš„é…ç½®ï¼š</p>
<pre><code>mysite.com, sub.mysite.com {
    gzip
    â€¦
}
</code></pre><p>å¾ˆç®€å•æ˜¯å§ï¼Œå¦å¤–ï¼ŒCaddyfile ä¸­ä½¿ç”¨ç¯å¢ƒå˜é‡ä¹Ÿæ˜¯å¯ä»¥çš„ã€‚</p>
<h2 id="Mac-ç¯å¢ƒé…ç½®"><a href="#Mac-ç¯å¢ƒé…ç½®" class="headerlink" title="Mac ç¯å¢ƒé…ç½®"></a>Mac ç¯å¢ƒé…ç½®</h2><p>å…ˆå» ä¸‹è½½<a href="https://github.com/mholt/caddy/blob/master/dist/init/mac-launchd/com.caddyserver.web.plist" target="_blank" rel="noopener"> <code>.plist</code> æ–‡ä»¶</a>ï¼Œè¿™æ˜¯ <code>mac</code> ä¸‹çš„å®šæ—¶ä»»åŠ¡é…ç½®æ–‡ä»¶ï¼ˆæœªé˜²å£è¯¯ï¼Œè¯´æ˜ä¸€ä¸‹ï¼Œæ˜¯ä¸€ä¸ªå…·ä½“äº‹ä»¶å¯¹åº”ä¸€ä¸ª <code>.plist</code>ï¼‰</p>
<h3 id="å¼€æœºå¯åŠ¨"><a href="#å¼€æœºå¯åŠ¨" class="headerlink" title="å¼€æœºå¯åŠ¨"></a>å¼€æœºå¯åŠ¨</h3><pre><code class="bash">cp ~/Download/com.caddyserver.web.plist /usr/local/opt/caddy/
ln -sfv /usr/local/opt/caddy/*.plist ~/Library/LaunchAgents
</code></pre>
<h3 id="åŸºæœ¬é…ç½®"><a href="#åŸºæœ¬é…ç½®" class="headerlink" title="åŸºæœ¬é…ç½®"></a>åŸºæœ¬é…ç½®</h3><pre><code class="bash">mkdir -p /usr/local/etc/caddy /usr/local/etc/ssl/caddy /var/log/caddy
touch /usr/local/opt/caddy/Caddyfile
sudo chown -R  _www:_www /usr/local/etc/caddy /var/log/caddy
sudo chmod 0750 /usr/local/etc/ssl/caddy
</code></pre>
<h4 id="è‡ªå®šä¹‰é…ç½®æ–‡ä»¶"><a href="#è‡ªå®šä¹‰é…ç½®æ–‡ä»¶" class="headerlink" title="è‡ªå®šä¹‰é…ç½®æ–‡ä»¶"></a>è‡ªå®šä¹‰é…ç½®æ–‡ä»¶</h4><p><strong>ä¿®æ”¹ <code>Caddyfile</code></strong>ï¼š</p>
<pre><code class="bash">sudo vim /usr/local/etc/caddy/Caddyfile
</code></pre>
<pre><code>http://localhost {
    root /var/www
}
</code></pre><p><strong>ä¿®æ”¹ <code>.plist</code> æ–‡ä»¶</strong></p>
<p>å› ä¸ºæ˜¯ç”¨ brew å®‰è£…ï¼Œå’Œå®˜ç½‘ä¸Šçš„é…ç½®æœ‰æ‰€å·®å¼‚ï¼Œä¿®æ”¹ <code>.plist</code> æ–‡ä»¶</p>
<pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;
&lt;plist version=&quot;1.0&quot;&gt;
&lt;dict&gt;
  &lt;key&gt;Label&lt;/key&gt;
  &lt;string&gt;Caddy&lt;/string&gt;
  &lt;key&gt;ProgramArguments&lt;/key&gt;
  &lt;array&gt;
    &lt;string&gt;/usr/local/bin/caddy&lt;/string&gt;
    &lt;string&gt;-agree&lt;/string&gt;
    &lt;string&gt;-conf&lt;/string&gt;
    &lt;string&gt;/usr/local/etc/caddy/Caddyfile&lt;/string&gt;
    &lt;string&gt;-root&lt;/string&gt;
    &lt;string&gt;/var/www&lt;/string&gt;
  &lt;/array&gt;
  &lt;key&gt;EnvironmentVariables&lt;/key&gt;
  &lt;dict&gt;
    &lt;key&gt;CADDYPATH&lt;/key&gt;
    &lt;string&gt;/usr/local/etc/ssl/caddy&lt;/string&gt;
  &lt;/dict&gt;

  &lt;key&gt;UserName&lt;/key&gt;
  &lt;string&gt;root&lt;/string&gt;
  &lt;key&gt;GroupName&lt;/key&gt;
  &lt;string&gt;wheel&lt;/string&gt;
  &lt;key&gt;InitGroups&lt;/key&gt;
  &lt;true/&gt;

  &lt;key&gt;RunAtLoad&lt;/key&gt;
  &lt;true/&gt;
  &lt;key&gt;KeepAlive&lt;/key&gt;
  &lt;dict&gt;
    &lt;key&gt;Crashed&lt;/key&gt;
    &lt;true/&gt;
  &lt;/dict&gt;

  &lt;key&gt;SoftResourceLimits&lt;/key&gt;
  &lt;dict&gt;
    &lt;key&gt;NumberOfFiles&lt;/key&gt;
    &lt;integer&gt;8192&lt;/integer&gt;
  &lt;/dict&gt;
  &lt;key&gt;HardResourceLimits&lt;/key&gt;
  &lt;dict/&gt;

  &lt;key&gt;WorkingDirectory&lt;/key&gt;
  &lt;string&gt;/usr/local/etc/ssl/caddy&lt;/string&gt;

  &lt;key&gt;StandardErrorPath&lt;/key&gt;
  &lt;string&gt;/var/log/caddy/error.log&lt;/string&gt;
  &lt;key&gt;StandardOutPath&lt;/key&gt;
  &lt;string&gt;/var/log/caddy/info.log&lt;/string&gt;
&lt;/dict&gt;
&lt;/plist&gt;
</code></pre><h2 id="å¯åŠ¨ã€åœæ­¢ã€é‡å¯æœåŠ¡"><a href="#å¯åŠ¨ã€åœæ­¢ã€é‡å¯æœåŠ¡" class="headerlink" title="å¯åŠ¨ã€åœæ­¢ã€é‡å¯æœåŠ¡"></a>å¯åŠ¨ã€åœæ­¢ã€é‡å¯æœåŠ¡</h2><p>ç”¨ <code>brew</code> å®‰è£…çš„ä¸€ä¸ªæå¤§ä¾¿åˆ©å°±æ˜¯å¯ä»¥ç›´æ¥ä½¿ç”¨ <code>brew services</code>ï¼š</p>
<pre><code class="bash"># start
brew services start caddy

# stop
brew services stop caddy

# restart
brew services restart caddy
</code></pre>
<h2 id="ä¸Šçº¿é¡¹ç›®è¿˜è¯·æ¢å›-nginx"><a href="#ä¸Šçº¿é¡¹ç›®è¿˜è¯·æ¢å›-nginx" class="headerlink" title="ä¸Šçº¿é¡¹ç›®è¿˜è¯·æ¢å› nginx"></a>ä¸Šçº¿é¡¹ç›®è¿˜è¯·æ¢å› nginx</h2><p>caddy è™½ç„¶ç®€å•ï¼Œä½†ä¹Ÿè¿˜æ˜¯æœ‰è‡ªèº«çš„é—®é¢˜ã€‚</p>
<ol>
<li>å•†ä¸šé¡¹ç›®éœ€è¦æ”¯ä»˜æˆæƒ</li>
<li><p>èµ„æºå ç”¨å¤šï¼Œé«˜å¹¶éä¸‹è¡¨ç°å’Œnginxè¿˜æ˜¯å­˜åœ¨è¾ƒå¤§å·®è·</p>
<p> å…·ä½“å¯å‚è€ƒï¼š<a href="https://community.centminmod.com/threads/caddy-http-2-server-benchmarks.5170/" target="_blank" rel="noopener">Caddy HTTP/2 server &amp; benchmarks</a>ï¼š</p>
<p> <img src="http://oe54phg1r.bkt.clouddn.com/blog/2017-09-20-124437.jpg" alt=""></p>
</li>
</ol>

  </article>
    
  </div>
</div>

    <footer class="main-footer">
  <div class="container">
    Â© 2018 
  </div>
</footer>
    



<script src="/./runtime.aacdc9.js"></script><script src="/./vendor.bb7611.js"></script><script src="/./app.590fd5.js"></script>


  </body>
</html>
