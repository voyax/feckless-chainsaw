<!DOCTYPE html><html lang="zh-cn"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=Edge"><meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="format-detection" content="email=no"><meta name="description" content="像孩子一样写代码"><meta name="keywords" content="CSS, JavaScript, NodeJS, Vue, React, Sketch, Git"><title>谈谈BFC - voya</title><link rel="stylesheet" href="/css/jquery.tocify.css"><link rel="stylesheet" href="/css/main_style.min.css"><link rel="icon" href="http://oe54phg1r.bkt.clouddn.com/favicon32x32.ico"></head><body><input id="navi" type="checkbox"><ul class="main-navication"><li><a href="/"><span>Home</span></a></li><li><a href="/categories/365/"><span>忆</span></a></li><li><a href="/categories/css-tutorial/"><span>CSS 教程</span></a></li></ul><div class="wrapper wrapper--article" id="wrap"><div id="toc"><div class="toc-text">Table of Content ▾</div></div><div class="post-header"><label class="navi-button light" for="navi">MENU</label><img class="background" src="http://oe54phg1r.bkt.clouddn.com/blog/2017-08-16-adam-whitlock-270558.jpg"><div class="post-title"><h1 class="title">谈谈BFC</h1><ul class="meta"><li><i class="icon icon-author"></i>voya</li><li><i class="icon icon-clock"></i>14 Minutes</li><li><i class="icon icon-calendar"></i>2016年4月11日</li></ul></div></div><div class="article-content" style="max-width:700px"><p>BFC牵扯了许多东西，能力时间有限，将逐渐补充先关内容。</p>
<h2 id="什么是BFC"><a href="#什么是BFC" class="headerlink" title="什么是BFC"></a>什么是BFC</h2><p>BFC（Block Formating Context）被称为块级格式化上下文。直白来讲，BFC只是一个概念，但凡符合这个定义的，便遵循BFC的渲染规则。</p>
<p><a href="https://www.w3.org/TR/CSS2/visuren.html#block-formatting" target="_blank" rel="external">官网描述</a>如下：</p>
<blockquote>
<p>Floats, absolutely positioned elements, block containers (such as inline-blocks, table-cells, and table-captions) that are not block boxes, and block boxes with ‘overflow’ other than ‘visible’ (except when that value has been propagated to the viewport) establish new block formatting contexts for their contents.</p>
</blockquote>
<p>也就是说，浮动、绝对定位元素（<code>position</code> 为 <code>absolute</code> 或 <code>fixed</code>）、行内块元素 <code>display:inline-block</code>、表格单元格 <code>display:table-cell</code>、表格标题 <code>display:table-caption</code> 以及 <code>overflow</code> 属性值不为 <code>visible</code> 的元素（除了该值被传播到视点 viewport 的情况）将创建一个新的块级格式化上下文。</p>
<a id="more"></a>
<blockquote>
<p>In a block formatting context, boxes are laid out one after the other, vertically, beginning at the top of a containing block. The vertical distance between two sibling boxes is determined by the ‘margin’ properties. Vertical margins between adjacent block-level boxes in a block formatting context collapse.</p>
</blockquote>
<p>在BFC内，盒子从<strong>包含块</strong>（这个概念要清楚(⊙o⊙)哦）顶端开始，按垂直方向一个接一个排列。相邻两个盒子之间的垂直距离有margin决定，但并非简单的两个margin之和，而是采用所谓的外边距折叠（Collapsing Margins ）</p>
<blockquote>
<p>In a block formatting context, each box’s left outer edge touches the left edge of the containing block (for right-to-left formatting, right edges touch). This is true even in the presence of floats (although a box’s line boxes may shrink due to the floats), unless the box establishes a new block formatting context (in which case the box itself may become narrower due to the floats).</p>
</blockquote>
<p>在BFC中，每个盒子的左外边距紧贴包含块（对于从右往左的布局中，正好相反）。需要注意的是，即使是浮动元素，也遵循这个规则，除非我们为这个盒子新建了一个BFC。</p>
<h2 id="BFC-规则概述"><a href="#BFC-规则概述" class="headerlink" title="BFC 规则概述"></a>BFC 规则概述</h2><p>根据官方描述，对BFC触发条件以及渲染规则总结：</p>
<h3 id="如何创建BFC"><a href="#如何创建BFC" class="headerlink" title="如何创建BFC"></a>如何创建BFC</h3><ol>
<li>浮动：<code>float</code>不为<code>none</code></li>
<li><code>postion</code>等于<code>absolute</code>或者<code>flex</code></li>
<li><code>display</code>等于<code>table-cell</code>、<code>table-caption</code>、<code>inline-block</code>、<code>flex</code> 或 <code>inline-flex</code></li>
<li><code>overflow</code>不为<code>visible</code></li>
</ol>
<p>这几个条件各有利弊，结合具体情况灵活使用。</p>
<h3 id="BFC特性"><a href="#BFC特性" class="headerlink" title="BFC特性"></a>BFC特性</h3><ol>
<li>属于同一BFC的相邻元素会发生外边距折叠（换句话说，如果不属于同一个BFC，那就不会折叠了）</li>
<li>BFC中的<code>float</code>元素会撑开容器</li>
<li>在BFC中，每个盒子的左外边距紧贴包含块</li>
</ol>
<h3 id="BFC应用举例——多栏布局"><a href="#BFC应用举例——多栏布局" class="headerlink" title="BFC应用举例——多栏布局"></a>BFC应用举例——多栏布局</h3><p>借用百度ife的一个任务：</p>
<p><strong>效果图：</strong></p>
<p><img alt="多栏布局" data-original="http://7fvhf8.com1.z0.glb.clouddn.com/ifetask_1_3_1.png"><br><strong>要求：</strong>改变中间一栏的内容长度，以确保在中间一栏较高和右边一栏较高时，父元素的高度始终为子元素中最高的高度</p>
<p>此题有多种优秀解决方案，在这我们关注如何利用BFC解决（这也是目前我认为此题最简单的解法）。</p>
<p><strong>解题思路：</strong></p>
<p>我们先让左侧和右侧站好位，剩下的空间给中间的模块。<br>左侧和右侧的两个盒子，那就直接采用float。但是有两个需要解决的地方：</p>
<ol>
<li>一个元素浮动时，其他内容会“环绕”该元素。结果就是如果两个侧栏的高度小于中间栏，那中间栏就会环绕两个侧栏了。</li>
<li>浮动元素已经从文档的正常流中删除，存在高度塌陷。当左右侧栏的高度均大于中间栏的高度，父元素高度无法撑开。</li>
</ol>
<h4 id="如何解决"><a href="#如何解决" class="headerlink" title="如何解决"></a>如何解决</h4><ul>
<li><p>避免环绕：首先要明白为何会存在“环绕”，原因在于，在BFC中，每个盒子的左外边距紧贴包含块的左侧。<br>  解决方法也很清楚了，让中间栏创建一个新的BFC就可以了。</p>
</li>
<li><p>高度：上文说过，BFC可以包含浮动元素；所以只要为父元素创建BFC够了。</p>
</li>
</ul>
<p><strong>HTML代码</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"left-box"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/logo.jpeg"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>九歌<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"right-box"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/qiu.jpeg"</span> <span class="attr">alt</span>=<span class="string">"秋"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/rui.png"</span> <span class="attr">alt</span>=<span class="string">"瑞"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"img/voya.jpeg"</span> <span class="attr">alt</span>=<span class="string">"运"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"center-box"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">h2</span>&gt;</span>关于我们<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">p</span>&gt;</span>一张褪色的照片</div><div class="line">好像带给我一点点怀念</div><div class="line">巷尾老爷爷卖的热汤面</div><div class="line">味道弥漫过旧旧的后院</div><div class="line">流浪猫睡熟在摇晃秋千</div><div class="line">夕阳照了一遍他咪着眼</div><div class="line">那张同桌寄的明信片</div><div class="line">安静的躺在课桌的里面</div><div class="line">快要过完的春天</div><div class="line">还有雕刻着图案的门帘</div><div class="line">窄窄的长长的过道两边</div><div class="line">老房子依然升起了炊烟</div><div class="line">刚刚下完了小雨的季节</div><div class="line">爸妈又一起走过的老街</div><div class="line">记不得哪年的哪一天</div><div class="line">很漫长又很短暂的岁月</div><div class="line">现在已经回不去</div><div class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<p><strong>CSS</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.container</span>&#123;</div><div class="line">    <span class="attribute">margin</span>:<span class="number">20px</span>;</div><div class="line">    <span class="attribute">border</span>: <span class="number">#999</span>;</div><div class="line">    <span class="attribute">background</span>: <span class="number">#eeeeee</span>;</div><div class="line">    <span class="attribute">overflow</span>: hidden;</div><div class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-tag">img</span>&#123;</div><div class="line">    <span class="attribute">height</span>: <span class="number">80px</span>;</div><div class="line">    <span class="attribute">width</span>: <span class="number">80px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.left-box</span>,<span class="selector-class">.center-box</span>,<span class="selector-class">.right-box</span>&#123;</div><div class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#999</span>;</div><div class="line">    <span class="attribute">padding</span>: <span class="number">20px</span>;</div><div class="line">    <span class="attribute">background</span>: <span class="number">#fff</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.left-box</span>&#123;</div><div class="line">    <span class="attribute">float</span>: left;</div><div class="line"></div><div class="line">    <span class="attribute">width</span>: <span class="number">158px</span>;</div><div class="line">    <span class="attribute">margin-right</span>: <span class="number">20px</span>;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.left-box</span> <span class="selector-tag">img</span>&#123;</div><div class="line">    <span class="attribute">float</span>: left;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.left-box</span> <span class="selector-tag">h2</span>&#123;</div><div class="line">    <span class="attribute">overflow</span>: hidden;</div><div class="line">    <span class="attribute">padding-left</span>: <span class="number">20px</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.right-box</span>&#123;</div><div class="line">    <span class="attribute">float</span>: right;</div><div class="line">    <span class="attribute">box-sizing</span>: <span class="number">120px</span>;</div><div class="line">    <span class="attribute">margin-left</span>: <span class="number">20px</span>;</div><div class="line"></div><div class="line">    <span class="attribute">text-align</span>: center;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="selector-class">.center-box</span>&#123;</div><div class="line">    <span class="attribute">overflow</span>: hidden;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</div><div class="article-meta" style="max-width:700px"><div class="tags"><i class="icon icon-tag"></i><ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CSS/">CSS</a><span class="tag-list-count">13</span></li></ul></div></div><ul class="navication"><li class="home"><a href="/"><i class="icon icon-home"></i></a></li><li><a href="/posts/279/"><i class="icon icon-arror-left"></i></a></li><li><a href="/posts/38426/"><i class="icon icon-arror-right"></i></a></li></ul><div class="page-footer"><div class="bottom"><div class="copyright">© 2017 voya<br><small>POWER BY <a href="https://hexo.io" target="_blank">HEXO</a></small></div></div></div></div><script src="https://cdn.staticfile.org/jquery/1.8.3/jquery.min.js"></script><script src="https://cdn.staticfile.org/jquery_lazyload/1.9.7/jquery.lazyload.min.js"></script><script src="/js/jquery-ui-1.9.1.custom.min.js"></script><script src="/js/jquery.tocify.min.js"></script><script>eval(function(p,a,c,k,e,r){e=function(c){return c.toString(a)};if(!''.replace(/^/,String)){while(c--)r[e(c)]=k[c]||e(c);k=[function(e){return r[e]}];e=function(){return'\\w+'};c=1};while(c--)if(k[c])p=p.replace(new RegExp('\\b'+e(c)+'\\b','g'),k[c]);return p}('c 4=0.p("4");8.9=5(){4.i+=" o";6(0.2("#1")){$("#1").3({d:"e",f:"g,h,7,j",k:l,}).m("1-3");n b=0.2("#1");5 a(){b.q.r("s")}0.2(".1-t").u("v",a);6(0.2(".3-w")){b.x.y="z"}}};',36,36,'document|toc|querySelector|tocify|wrap|function|if|h4|window|onload|||var|context|body|selectors|h2|h3|className|h5|extendPage|false|data|const|done|getElementById|classList|toggle|show|text|addEventListener|mouseenter|header|style|display|block'.split('|'),0,{}))
$(function(){$(".post-list img, .article-content img").lazyload({placeholder:"http://oe54phg1r.bkt.clouddn.com/typing-preloader.svg",effect:"fadeIn"})});</script></body></html>