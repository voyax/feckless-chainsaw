<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><title>（转|译）在AngularJS中使用的表单验证功能 | voya</title><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.3"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.1.1/dist/instantsearch.min.js" defer></script><script>var GLOBAL = { 
  root: '/',
  algolia: {"appId":"TJ6WR04MZ3","apiKey":"81961c3645425e892e7caa399f73e5b2","indexName":"blog","hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  localSearch: undefined
} </script><link rel="icon" href="/favicon.ico"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#必填"><span class="toc-number">1.</span> <span class="toc-text">必填</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最小长度"><span class="toc-number">2.</span> <span class="toc-text">最小长度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#最大长度"><span class="toc-number">3.</span> <span class="toc-text">最大长度</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#正则匹配"><span class="toc-number">4.</span> <span class="toc-text">正则匹配</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Email"><span class="toc-number">5.</span> <span class="toc-text">Email</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#数字"><span class="toc-number">6.</span> <span class="toc-text">数字</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Url"><span class="toc-number">7.</span> <span class="toc-text">Url</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#自定义验证"><span class="toc-number">8.</span> <span class="toc-text">自定义验证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#验证表单状态"><span class="toc-number">9.</span> <span class="toc-text">验证表单状态</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#未修改过的表单"><span class="toc-number">9.1.</span> <span class="toc-text">未修改过的表单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#修改的表单"><span class="toc-number">9.2.</span> <span class="toc-text">修改的表单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#经过验证的表单"><span class="toc-number">9.3.</span> <span class="toc-text">经过验证的表单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#表示否通过验证："><span class="toc-number">9.4.</span> <span class="toc-text">表示否通过验证：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#未通过验证的表单"><span class="toc-number">9.5.</span> <span class="toc-text">未通过验证的表单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#错误"><span class="toc-number">9.6.</span> <span class="toc-text">错误</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#控制验证时的样式"><span class="toc-number">9.7.</span> <span class="toc-text">控制验证时的样式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#全部放一起试试"><span class="toc-number">10.</span> <span class="toc-text">全部放一起试试</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#让我们定义一个form表单"><span class="toc-number">10.1.</span> <span class="toc-text">让我们定义一个form表单:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#现在，让我们添加用户的Name"><span class="toc-number">10.2.</span> <span class="toc-text">现在，让我们添加用户的Name:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#让我们接着看Email验证"><span class="toc-number">10.3.</span> <span class="toc-text">让我们接着看Email验证:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#最后，让我们来看看在我们的最后一个验证，用户名："><span class="toc-number">10.4.</span> <span class="toc-text">最后，让我们来看看在我们的最后一个验证，用户名：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更新"><span class="toc-number">11.</span> <span class="toc-text">更新:</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#更新-2"><span class="toc-number">12.</span> <span class="toc-text">更新 2:</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#点击提交后显示验证信息"><span class="toc-number">12.1.</span> <span class="toc-text">点击提交后显示验证信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#当时去焦点时验证错误"><span class="toc-number">12.2.</span> <span class="toc-text">当时去焦点时验证错误</span></a></li></ol></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="http://oe54phg1r.bkt.clouddn.com/blog/2017-09-26-2017-07-26-075816%20.jpg"></div><div class="author-info__name text-center">voya</div><div class="author-info__description text-center">Reading, Collecting, Thinking and Doing</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="../../archives"><span class="pull-left">文章</span><span class="pull-right">150</span></a><a class="author-info-articles__tags article-meta" href="../../tags"><span class="pull-left">标签</span><span class="pull-right">32</span></a><a class="author-info-articles__categories article-meta" href="../../categories"><span class="pull-left">分类</span><span class="pull-right">8</span></a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(http://oe54phg1r.bkt.clouddn.com/blog/2017-09-26-2017-08-16-adam-whitlock-270558-cmp.jpg);"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">voya</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="post-info"><div id="post-title">（转|译）在AngularJS中使用的表单验证功能</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2015-08-06</time><span class="post-meta__separator">|</span><i class="fa fa-tag post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="../../tags/AngularJS/">AngularJS</a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">2,899</span><span class="post-meta__separator">|</span><span>阅读时长: 12 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><p>验证功能是AngularJS里面最酷炫的功能之一，它可以让你写出一个具有良好用户体验的Web应用。</p>
<p>在AngularJS中，有许多用于验证的指令。我们将先学习几个最流行的内置指令，然后再创建一个自定义验证规则的指令。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">"form"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">name</span>=<span class="string">"email"</span>&gt;</span>Your email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">ng-model</span>=<span class="string">"email"</span> <span class="attr">placeholder</span>=<span class="string">"Email Address"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>AngularJS</strong>可以让我们轻松的处理客户端验证。虽然我们不能仅靠客户端验证来保证我们Web应用的安全性，但他们提供了良好用户体验。</p>
<a id="more"></a>
<p>我们首先必须确保<strong>form</strong>上标签有一个<strong>name</strong>属性，像上面的例子一样。</p>
<p>我们可以进行一些基本的验证，例如最小长度，最大长度，等等，这些都是<strong>HTML5</strong>自带的属性验证功能。</p>
<p><strong>Tips:</strong>通常需要在form标签中加上<strong>novalidate</strong>属性，这样可以禁用浏览器自带的验证功能，从而使用<strong>AngularJS</strong>提供的。</p>
<p>下面来看看我们可以在input中设置哪些验证：</p>
<h2 id="必填"><a href="#必填" class="headerlink" title="必填"></a>必填</h2><p>验证是否已输入文字，只需在标签上加上<strong>required</strong>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">required</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="最小长度"><a href="#最小长度" class="headerlink" title="最小长度"></a>最小长度</h2><p>验证至少输入<code>{number}</code>个字符，使用指令<code>ng-minlength=&quot;{number}&quot;</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-minlength</span>=<span class="string">5</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="最大长度"><a href="#最大长度" class="headerlink" title="最大长度"></a>最大长度</h2><p>验证至多输入<code>{number}</code>个字符，使用指令<code>ng-maxlength=&quot;{number}&quot;</code>：</p>
<h2 id="正则匹配"><a href="#正则匹配" class="headerlink" title="正则匹配"></a>正则匹配</h2><p>确保输入匹配一个<strong>正则表达式</strong>，使用指令<code>ng-pattern=&quot;/PATTERN/&quot;</code>:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">ng-pattern</span>=<span class="string">"/a-zA-Z/"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Email"><a href="#Email" class="headerlink" title="Email"></a>Email</h2><p>验证输入是一个<strong>Email</strong>，设置input的type属性为<code>email</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> <span class="attr">name</span>=<span class="string">"email"</span> <span class="attr">ng-model</span>=<span class="string">"user.email"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="数字"><a href="#数字" class="headerlink" title="数字"></a>数字</h2><p>验证输入是一个<strong>数字</strong>，设置input的type属性为<code>number</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"number"</span> <span class="attr">name</span>=<span class="string">"number"</span> <span class="attr">ng-model</span>=<span class="string">"user.age"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Url"><a href="#Url" class="headerlink" title="Url"></a>Url</h2><p>验证输入是一个<strong>URL</strong>，设置input的type属性为<code>url</code>：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"url"</span> <span class="attr">name</span>=<span class="string">"homepage"</span> <span class="attr">ng-model</span>=<span class="string">"user.facebook_url"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="自定义验证"><a href="#自定义验证" class="headerlink" title="自定义验证"></a>自定义验证</h2><p>AngularJS可以很容易的使用指令来添加自定义验证。例如，我们要验证我们的用户名是可用的（在数据库中不重复）。要做到这一点，我们将实现一个指令，它在输入字符变化时触发一个<strong>Ajax</strong>请求：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> app = angular.module(<span class="string">'validationExample'</span>, []);</span><br><span class="line"></span><br><span class="line">app.directive(<span class="string">'ensureUnique'</span>, [<span class="string">'$http'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$http</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="built_in">require</span>: <span class="string">'ngModel'</span>,</span><br><span class="line">    link: <span class="function"><span class="keyword">function</span>(<span class="params">scope, ele, attrs, c</span>) </span>&#123;</span><br><span class="line">      scope.$watch(attrs.ngModel, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $http(&#123;</span><br><span class="line">          method: <span class="string">'POST'</span>,</span><br><span class="line">          url: <span class="string">'/api/check/'</span> + attrs.ensureUnique,</span><br><span class="line">          data: &#123;<span class="string">'field'</span>: attrs.ensureUnique&#125;</span><br><span class="line">        &#125;).success(<span class="function"><span class="keyword">function</span>(<span class="params">data, status, headers, cfg</span>) </span>&#123;</span><br><span class="line">          c.$setValidity(<span class="string">'unique'</span>, data.isUnique);</span><br><span class="line">        &#125;).error(<span class="function"><span class="keyword">function</span>(<span class="params">data, status, headers, cfg</span>) </span>&#123;</span><br><span class="line">          c.$setValidity(<span class="string">'unique'</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;]);</span><br></pre></td></tr></table></figure>
<h2 id="验证表单状态"><a href="#验证表单状态" class="headerlink" title="验证表单状态"></a>验证表单状态</h2><p>AngularJS将DOM验证的结果保存在$scope对象中。这使我们能够实时做出一些处理。提供给我们的属性有：</p>
<p>请注意，这是这个属性的格式：</p>
<p><code>formName.inputFieldName.property</code></p>
<h3 id="未修改过的表单"><a href="#未修改过的表单" class="headerlink" title="未修改过的表单"></a>未修改过的表单</h3><p>表示用户是否修改了表单。如果为ture，表示没有修改过：</p>
<p><code>formName.inputFieldName.$pristine;</code></p>
<h3 id="修改的表单"><a href="#修改的表单" class="headerlink" title="修改的表单"></a>修改的表单</h3><p>当且用户是否已经修改过表单：</p>
<p><code>formName.inputFieldName.$dirty</code></p>
<h3 id="经过验证的表单"><a href="#经过验证的表单" class="headerlink" title="经过验证的表单"></a>经过验证的表单</h3><h3 id="表示否通过验证："><a href="#表示否通过验证：" class="headerlink" title="表示否通过验证："></a>表示否通过验证：</h3><p><code>formName.inputFieldName.$valid</code></p>
<h3 id="未通过验证的表单"><a href="#未通过验证的表单" class="headerlink" title="未通过验证的表单"></a>未通过验证的表单</h3><p>表示否通过验证。如果表单当前没有通过验证，他将为true：</p>
<p><code>formName.inputFieldName.$invalid</code></p>
<p>最后两个属性在用于DOM元素的显示或隐藏时是特别有用的。当然，如果想要设置特定的class时，他们也是非常有用的。</p>
<h3 id="错误"><a href="#错误" class="headerlink" title="错误"></a>错误</h3><p>另一个有用的属性是AngularJS提供的<code>$error</code>对象。这个对象包含每一个无效的input验证的集合。为了访问这个属性，使用下面的语法：</p>
<p><code>formName.inputfieldName.$error</code></p>
<p>如果验证失败，则此属性将是<code>true</code>的(因为<code>length&gt;0</code>)。</p>
<h3 id="控制验证时的样式"><a href="#控制验证时的样式" class="headerlink" title="控制验证时的样式"></a>控制验证时的样式</h3><p>当AngularJS处理的验证时，它将根据验证的状态增加一些特定的class属性。</p>
<p>这些class是:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.ng-pristine</span> &#123;&#125;</span><br><span class="line"><span class="selector-class">.ng-dirty</span> &#123;&#125;</span><br><span class="line"><span class="selector-class">.ng-valid</span> &#123;&#125;</span><br><span class="line"><span class="selector-class">.ng-invalid</span> &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>这些class对应着其对应的验证对象的结果。</p>
<p>当一个字段是无效的，<code>.ng-invalid</code>将被应用到这个字段上。我们可以通过css来设置这些class的样式:</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">input</span><span class="selector-class">.ng-invalid</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid red;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">input</span><span class="selector-class">.ng-valid</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid green;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="全部放一起试试"><a href="#全部放一起试试" class="headerlink" title="全部放一起试试"></a>全部放一起试试</h2><p>让我们编写一个注册表单。本申请表单将包括姓名，Email，以及用户名。</p>
<h3 id="让我们定义一个form表单"><a href="#让我们定义一个form表单" class="headerlink" title="让我们定义一个form表单:"></a>让我们定义一个form表单:</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">"signup_form"</span> <span class="attr">novalidate</span> <span class="attr">ng-submit</span>=<span class="string">"signupForm()"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">fieldset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">legend</span>&gt;</span>Signup<span class="tag">&lt;/<span class="name">legend</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"button radius"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这个表单的名字是<code>signup_form</code> ，当我们点击提交时我们将调用<code>signupForm()</code>方法.</p>
<h3 id="现在，让我们添加用户的Name"><a href="#现在，让我们添加用户的Name" class="headerlink" title="现在，让我们添加用户的Name:"></a>现在，让我们添加用户的<code>Name</code>:</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Your name<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">"Name"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">"name"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">ng-model</span>=<span class="string">"signup.name"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">ng-minlength</span>=<span class="string">3</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">ng-maxlength</span>=<span class="string">20</span> <span class="attr">required</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>我们增加了一个名字为<code>name</code>的输入框，并且将对象绑定在<code>$scope</code>对象的<code>signup.name</code>对象上（通过<code>ng-model</code>）。</p>
<p>我们还设置了几个验证。这些验证分别是：必须有一个长度为3或更多的名字。并且最大长度限制为20个字符。最后，名称应该是必填的。</p>
<p>让我们用属性来控制显示还是隐藏错误信息。我们还将使用$dirty属性，以确保当用户没有输入字符前错误信息不会显示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Your name<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">"Name"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">name</span>=<span class="string">"name"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">ng-model</span>=<span class="string">"signup.name"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">ng-minlength</span>=<span class="string">3</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">ng-maxlength</span>=<span class="string">20</span> <span class="attr">required</span> /&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">ng-show</span>=<span class="string">"signup_form.name.$dirty &amp;&amp; signup_form.name.$invalid"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">ng-show</span>=<span class="string">"signup_form.name.$error.required"</span>&gt;</span></span><br><span class="line">        Your name is required.</span><br><span class="line">    <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">ng-show</span>=<span class="string">"signup_form.name.$error.minlength"</span>&gt;</span></span><br><span class="line">            Your name is required to be at least 3 characters</span><br><span class="line">    <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">ng-show</span>=<span class="string">"signup_form.name.$error.maxlength"</span>&gt;</span></span><br><span class="line">            Your name cannot be longer than 20 characters</span><br><span class="line">    <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在之前，当输入内容改变时它只能告诉我们我们输入是否有效。现在，我们将看到当那些没有通过的验证时的错误信息。</p>
<h3 id="让我们接着看Email验证"><a href="#让我们接着看Email验证" class="headerlink" title="让我们接着看Email验证:"></a>让我们接着看Email验证:</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span>          </span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">label</span>&gt;</span>Your email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"email"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">placeholder</span>=<span class="string">"Email"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">name</span>=<span class="string">"email"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">ng-model</span>=<span class="string">"signup.email"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">ng-minlength</span>=<span class="string">3</span> <span class="attr">ng-maxlength</span>=<span class="string">20</span> <span class="attr">required</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">         <span class="attr">ng-show</span>=<span class="string">"signup_form.email.$dirty &amp;&amp; signup_form.email.$invalid"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">ng-show</span>=<span class="string">"signup_form.email.$error.required"</span>&gt;</span></span><br><span class="line">             Your email is required.</span><br><span class="line">      <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">ng-show</span>=<span class="string">"signup_form.email.$error.minlength"</span>&gt;</span></span><br><span class="line">              Your email is required to be at least 3 characters</span><br><span class="line">      <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">ng-show</span>=<span class="string">"signup_form.email.$error.email"</span>&gt;</span></span><br><span class="line">             That is not a valid email. Please input a valid email.</span><br><span class="line">      <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">             <span class="attr">ng-show</span>=<span class="string">"signup_form.email.$error.maxlength"</span>&gt;</span></span><br><span class="line">              Your email cannot be longer than 20 characters</span><br><span class="line">      <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>这一次，我们增加了<strong>Email</strong>字段。请注意，我们设置了input的type属性为email并且添加了$error.email错误信息。这是基于AngularJS的Email验证（使用了HTML5属性）。</p>
<h3 id="最后，让我们来看看在我们的最后一个验证，用户名："><a href="#最后，让我们来看看在我们的最后一个验证，用户名：" class="headerlink" title="最后，让我们来看看在我们的最后一个验证，用户名："></a>最后，让我们来看看在我们的最后一个验证，用户名：</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span>&gt;</span>Username<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span>  <span class="attr">type</span>=<span class="string">"text"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">placeholder</span>=<span class="string">"Desired username"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">name</span>=<span class="string">"username"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">ng-model</span>=<span class="string">"signup.username"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">ng-minlength</span>=<span class="string">3</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">ng-maxlength</span>=<span class="string">20</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">ensure-unique</span>=<span class="string">"username"</span> <span class="attr">required</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"error"</span> <span class="attr">ng-show</span>=<span class="string">"signup_form.username.$dirty &amp;&amp; signup_form.username.$invalid"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> <span class="attr">ng-show</span>=<span class="string">"signup_form.username.$error.required"</span>&gt;</span>Please input a username<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> <span class="attr">ng-show</span>=<span class="string">"signup_form.username.$error.minlength"</span>&gt;</span>Your username is required to be at least 3 characters<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> <span class="attr">ng-show</span>=<span class="string">"signup_form.username.$error.maxlength"</span>&gt;</span>Your username cannot be longer than 20 characters<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> <span class="attr">ng-show</span>=<span class="string">"signup_form.username.$error.unique"</span>&gt;</span>That username is taken, please try another<span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在我们的最后一个字段，我们使用之前编写的自定义验证指令：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">app.directive(<span class="string">'ensureUnique'</span>, [<span class="string">'$http'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">$http</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    <span class="built_in">require</span>: <span class="string">'ngModel'</span>,</span><br><span class="line">    link: <span class="function"><span class="keyword">function</span>(<span class="params">scope, ele, attrs, c</span>) </span>&#123;</span><br><span class="line">      scope.$watch(attrs.ngModel, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        $http(&#123;</span><br><span class="line">          method: <span class="string">'POST'</span>,</span><br><span class="line">          url: <span class="string">'/api/check/'</span> + attrs.ensureUnique,</span><br><span class="line">          data: &#123;<span class="string">'field'</span>: attrs.ensureUnique&#125;</span><br><span class="line">        &#125;).success(<span class="function"><span class="keyword">function</span>(<span class="params">data, status, headers, cfg</span>) </span>&#123;</span><br><span class="line">          c.$setValidity(<span class="string">'unique'</span>, data.isUnique);</span><br><span class="line">        &#125;).error(<span class="function"><span class="keyword">function</span>(<span class="params">data, status, headers, cfg</span>) </span>&#123;</span><br><span class="line">          c.$setValidity(<span class="string">'unique'</span>, <span class="literal">false</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;]);</span><br></pre></td></tr></table></figure>
<p>当表单输入是有效的时，它将发送POST api/check/username请求到服务器来检查用户名是否可用。很明显，因为我们在这里只谈论前端代码，我们写后端代码，尽管很容易。</p>
<h2 id="更新"><a href="#更新" class="headerlink" title="更新:"></a>更新:</h2><p>根据评论，我加入了服务器超时检查。要查看完整的源代码，请点击<a href="https://gist.github.com/auser/6417470" target="_blank" rel="noopener">here</a>。</p>
<p>最后，我们加上提交按钮，根据验证是否有效使用<code>ng-disabled</code>来控制按钮的禁用和启用：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">ng-disabled</span>=<span class="string">"signup_form.$invalid"</span> <span class="attr">class</span>=<span class="string">"button radius"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>正如我们上面所说的，表单是否有效的属性<code>$invalid</code>给我们提供了便利。</p>
<h2 id="更新-2"><a href="#更新-2" class="headerlink" title="更新 2:"></a>更新 2:</h2><p>虽然及时验证很棒，它可以立即提醒用户，但是当他们正在输入很长的能通过验证的文字时，他们将在输入中途看到错误提示。有更好的方式来处理验证：当用户点击提交时，或者当他们将光标移开输入框之后。让我们来看看这2种方式。</p>
<h3 id="点击提交后显示验证信息"><a href="#点击提交后显示验证信息" class="headerlink" title="点击提交后显示验证信息"></a>点击提交后显示验证信息</h3><p>要在用户试图提交表单时显示的验证，你可以通过在scope中设置一个’submitted’值，并检查该值来控制显示错误。</p>
<p>让我们来看看第一个例子，只有在点击提交表单时才显示错误。使用<code>ng-show</code>指令来控制显示，我们可以添加一个检查，看是否已点击提交按钮：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">name</span>=<span class="string">"signup_form"</span> <span class="attr">novalidate</span> <span class="attr">ng-submit</span>=<span class="string">"signupForm()"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">fieldset</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">legend</span>&gt;</span>Signup<span class="tag">&lt;/<span class="name">legend</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"row"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span>&gt;</span>Your name<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">placeholder</span>=<span class="string">"Name"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">name</span>=<span class="string">"name"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">ng-model</span>=<span class="string">"signup.name"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">ng-minlength</span>=<span class="string">3</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">ng-maxlength</span>=<span class="string">20</span> <span class="attr">required</span> /&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">ng-show</span>=<span class="string">"signup_form.name.$dirty &amp;&amp; signup_form.name.$invalid &amp;&amp; signup_form.submitted"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">            <span class="attr">ng-show</span>=<span class="string">"signup_form.name.$error.required"</span>&gt;</span></span><br><span class="line">            Your name is required.</span><br><span class="line">        <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">ng-show</span>=<span class="string">"signup_form.name.$error.minlength"</span>&gt;</span></span><br><span class="line">                Your name is required to be at least 3 characters</span><br><span class="line">        <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">small</span> <span class="attr">class</span>=<span class="string">"error"</span> </span></span><br><span class="line"><span class="tag">                <span class="attr">ng-show</span>=<span class="string">"signup_form.name.$error.maxlength"</span>&gt;</span></span><br><span class="line">                Your name cannot be longer than 20 characters</span><br><span class="line">        <span class="tag">&lt;/<span class="name">small</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">class</span>=<span class="string">"button radius"</span>&gt;</span>Submit<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">fieldset</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>现在，那个错误信息只将在<code>signup_form.submitted</code>为<code>true</code>时才显示。我们可以这样实现<code>signupForm</code>方法：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">app.controller('signupController', ['$scope', function($scope) &#123;</span><br><span class="line">  $scope.submitted = false;</span><br><span class="line">  $scope.signupForm = function() &#123;</span><br><span class="line">    if ($scope.signup_form.$valid) &#123;</span><br><span class="line">      // Submit as normal</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      $scope.signup_form.submitted = true;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;]);</span><br></pre></td></tr></table></figure>
<p>现在，当用户尝试提交表单并且同时有一个无效的元素时，你可以捕获它，并告诉他们错误的原因。</p>
<h3 id="当时去焦点时验证错误"><a href="#当时去焦点时验证错误" class="headerlink" title="当时去焦点时验证错误"></a>当时去焦点时验证错误</h3><p>如果你想保留错误验证的实时性，那么可以在用户离开该输入框时显示错误信息。要做到这一点，我们可以添加一个指令，将添加一个新的变量。</p>
<p>我们使用ngFocus指令：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">app.directive(<span class="string">'ngFocus'</span>, [<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> FOCUS_CLASS = <span class="string">"ng-focused"</span>;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    restrict: <span class="string">'A'</span>,</span><br><span class="line">    <span class="built_in">require</span>: <span class="string">'ngModel'</span>,</span><br><span class="line">    link: <span class="function"><span class="keyword">function</span>(<span class="params">scope, element, attrs, ctrl</span>) </span>&#123;</span><br><span class="line">      ctrl.$focused = <span class="literal">false</span>;</span><br><span class="line">      element.bind(<span class="string">'focus'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">        element.addClass(FOCUS_CLASS);</span><br><span class="line">        scope.$apply(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;ctrl.$focused = <span class="literal">true</span>;&#125;);</span><br><span class="line">      &#125;).bind(<span class="string">'blur'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">evt</span>) </span>&#123;</span><br><span class="line">        element.removeClass(FOCUS_CLASS);</span><br><span class="line">        scope.$apply(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;ctrl.$focused = <span class="literal">false</span>;&#125;);</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;]);</span><br></pre></td></tr></table></figure>
<p>要使用<code>ngFocus</code>，我们只需要简单加上这个指令到输入框元素上，像这样：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">ng-class</span>=<span class="string">"&#123;error: signup_form.name.$dirty &amp;&amp; signup_form.name.$invalid&#125;"</span> </span></span><br><span class="line"><span class="tag"><span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"Name"</span> <span class="attr">name</span>=<span class="string">"name"</span> </span></span><br><span class="line"><span class="tag"><span class="attr">ng-model</span>=<span class="string">"signup.name"</span> <span class="attr">ng-minlength</span>=<span class="string">3</span> <span class="attr">ng-maxlength</span>=<span class="string">20</span> <span class="attr">required</span> <span class="attr">ng-focus</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>加上<code>ngFocus</code>指令后，将在输入框的<code>blur</code>和<code>focus</code>事件中注册相应操作，当焦点在该输入框时，它添加一个<code>class（ng-focused）</code>，并且该输入框的<code>$focused</code>属性也将变为<code>true</code>。因此，你可以根据需求是否在焦点上来个性化设置显示错误消息。例如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"error"</span> <span class="attr">ng-show</span>=<span class="string">"signup_form.name.$dirty &amp;&amp; signup_form.name.$invalid &amp;&amp; !signup_form.name.$focused"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>我希望这篇文章可以告诉你如何很酷炫的使用AngularJS来进行验证。</p>
<p>原文：<a href="http://www.ng-newsletter.com/posts/validations.html" target="_blank" rel="noopener">Form validation with AngularJS (en)</a><br>译文原文：<a href="http://www.cnblogs.com/woshinidezhu/p/form-validation-with-angularjs.html" target="_blank" rel="noopener">http://www.cnblogs.com/woshinidezhu/p/form-validation-with-angularjs.html</a></p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info">voya</span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info">http://www.voyax.meposts/45363/</span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="../../tags/AngularJS/">AngularJS</a></div></article><nav id="pagination"><div class="prev-post pull-left"><a href="../../posts/12846/"><i class="fa fa-chevron-left">  </i><span>函数表达式-JavaScript</span></a></div><div class="next-post pull-right"><a href="../../posts/19847/"><span>60分钟搞定AngularJS——Getting Started</span><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">©2016 - 2018 By voya</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Hosted by - </span><a href="https://pages.coding.me/"><span>Coding Pages</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.3"></script><script src="/js/fancybox.js?version=1.3"></script><script src="/js/sidebar.js?version=1.3"></script><script src="/js/copy.js?version=1.3"></script><script src="/js/fireworks.js?version=1.3"></script><script src="/js/transition.js?version=1.3"></script><script src="/js/scroll.js?version=1.3"></script><script src="/js/head.js?version=1.3"></script></body></html>